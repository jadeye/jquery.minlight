/**
 * @license minLight.js
 * A minimal lightbox that fades in/out a specified target
 *   and builds a target with an image only if it is not already on the page
 * Copyright (c) 2012 timmy willison
 * Dual licensed under the MIT and GPL licenses.
 * http://timmywillison.com/licence/
 */(function(a){typeof define=="function"&&define.amd?define(["jquery"],a):a(jQuery)})(function(a){"use strict";var b=/[^A-Za-z]/g,c=/([a-z]+)([A-Z])/g,d=function(a,b,c){return b+("-"+c).toLowerCase()},e=Array.prototype.slice,f=function(b,e){this.elem=b;var f=this.$elem=a(b);a.each(e,function(a){var b=f.attr("data-"+a.replace(c,d));b!==undefined&&(e[a]=b)}),this.options=e,this._setTarget(e.target),this.bind(),this.opened=!1};return f.defaults={fadeTime:"fast",easing:"swing",container:"body",target:"",maskClass:"",href:"",imgWidth:"auto",imgHeight:"auto",closeOnMaskClick:!0,expandMask:!0,skeleton:"<div class='lightbox'><a href='#' class='lightbox-close ir'>X</a></div>"},f.prototype={_setTarget:function(c){var d,e=this.elem,f=this.$elem,g=this.options,h=a(c);h.length?h.data("_minNumAttached",(h.data("_minNumAttached")||0)+1):(d=h.selector.replace(b,""),this.$img=a("<img>").attr({alt:f.attr("title"),src:g.href||e.href,width:g.imgWidth,height:g.imgHeight}),h=a(g.skeleton).data("_minGenerated",!0).prepend(this.$img).appendTo(g.container),d&&h.attr("id",d)),h.length||a.error("minLight - specified container is not on the page: "+c),this.$mask=h.prev(".lightbox-mask"),this.$mask.length||(this.$mask=a("<div class='lightbox-mask'></div>").addClass(g.maskClass).insertBefore(h),g.expandMask&&this._expandMask()),this.$target=h,this.$close=h.find(".lightbox-close")},_expandMask:function(){var b=a(document).height(),c=a(window).height();this.$mask.height(b>c?b:c)},open:function(b){if(this.opened)return;var c=this.options,d=c.fadeTime,e=c.easing;this.opened=!0,this.$mask.stop(!0,!0).fadeIn(d,e),this.$target.stop(!0,!0).fadeIn(d,e,function(){a.isFunction(b)&&b.call(this),a.isFunction(c.onOpen)&&c.onOpen.call(this)})},close:function(b){if(!this.opened)return;var c=this.options,d=c.fadeTime,e=c.easing;this.opened=!1,this.$mask.stop(!0,!0).fadeOut(d,e),this.$target.stop(!0,!0).fadeOut(d,e,function(){a.isFunction(b)&&b.call(this),a.isFunction(c.onClose)&&c.onClose.call(this)})},bind:function(){var b=this.$elem,c=this.$close,d=this;a.nodeName(b[0],"a")?b.on("click.minlight",function(a){a.preventDefault(),d.$target.css("display")!=="none"?d.close():d.open()}):b.prop("tabIndex")!==undefined?b.on("focus.minlight",function(){d.open(function(){b.blur()})}):a.error("minLight - element is not clickable or focusable: "+b[0].nodeName),this.options.closeOnMaskClick&&(c=c.add(this.$mask)),c.bind("click.minlight",function(a){a.preventDefault(),d.close()})},unbind:function(){this.$elem.add(this.$mask).add(this.$close).unbind(".minlight")},_removeTarget:function(){var a=this.$target,b=a.data("_minNumAttached"),c=a.data("_minGenerated");if(!b||b<=1)c&&a.remove(),this.$mask.remove();a.data("_minNumAttached",b&&b-1)},destroy:function(){this.unbind(),this._removeTarget(),this.$elem.removeData("_minLight")},_setOptions:function(b){var c=this;a.each(b,function(b,d){switch(b){case"container":d=a(d);if(!d.length)return;d.append(c.$mask,c.$target);break;case"target":c._removeTarget(),c._setTarget(d);break;case"imgWidth":case"imgHeight":c.$img&&c.$elem.attr("data-"+b)===undefined&&c.$img[b.replace("img","").toLowerCase()](d)}c.options[b]=d;switch(b){case"fadeTime":case"easing":c.unbind(),c.bind()}})},option:function(b,c){var d;if(!b)return a.extend({},this.options);if(typeof b=="string"){if(c===undefined)return this.options[b];d={},d[b]=c}else d=b;this._setOptions(d)},instance:function(){return this}},a.fn.minLight=function(b){var c,d,g,h=[];return typeof b=="string"?(d=e.call(arguments,1),this.each(function(){c=a.data(this,"_minLight"),c&&b.charAt(0)!=="_"&&typeof (g=c[b])=="function"&&(g=g.apply(c,d))!==undefined&&h.push(g)}),h.length?h.length===1?h[0]:h:this):(b=a.extend({},f.defaults,b),this.each(function(){a.data(this,"_minLight")||a.data(this,"_minLight",new f(this,b))}))},f});