/**
 * @license minLight.js v0.4.0
 * Updated: Wed Apr 24 2013
 * A minimal lightbox that fades in/out a specified target
 * Copyright (c) 2013 timmy willison
 * Released under the MIT license
 * https://github.com/timmywil/jquery-minlight/blob/master/MIT-LICENSE.txt
 */
(function(t){"function"==typeof define&&define.amd?define(["jquery"],t):t(jQuery)})(function(t){"use strict";var e="__minlight",i=/([A-Z])/g,s=Array.prototype.slice,a=function(s,n){var o=t.data(s,e);if(o)return o;if(!(this instanceof a))return new a(s,n);this.elem=s;var h=this.$elem=t(s);this.options=n=t.extend({},a.defaults,n),t.each(n,function(t){var e=h.attr("data-"+t.replace(i,"-$1").toLowerCase());void 0!==e&&(n[t]=e)}),this.content=n.content,this._setTarget(),this.bind(),this.opened=!1,t.data(s,e,this)};return a.defaults={namespace:".minlight",fadeTime:200,easing:"swing",container:"body",transition:!1,lightboxClass:"lightbox",maskClass:"lightbox-mask",openClass:"lightbox-open",closedClass:"lightbox-closed",closeOnMaskClick:!0,expandMask:!0,disableMask:!1,target:"",href:"",imgWidth:"auto",imgHeight:"auto",skeleton:"<div><a href='#' class='lightbox-close' data-bypass>X</a></div>"},a.prototype={constructor:a,instance:function(){return this},open:function(e){function i(){s.opened=!0,t.isFunction(e)&&e.call(h[0],s),s._trigger("open")}if(!this.opened){var s=this,a=this.options,n=a.fadeTime,o=a.easing,h=this.$target,r=-1*(h.outerWidth()/2);this._trigger("willopen"),h.css("marginLeft",r),a.transition?(h.show(),setTimeout(function(){h.removeClass(a.closedClass).addClass(a.openClass)}),setTimeout(i,n)):h.stop().fadeIn(n,o,i),a.disableMask||(a.expandMask&&this._expandMask(),this.$mask.stop().fadeIn(n,o))}},close:function(e){function i(){h.hide(),t.isFunction(e)&&e.call(h[0],s),s._trigger("close")}if(this.opened){var s=this,a=this.options,n=a.fadeTime,o=a.easing,h=this.$target;this._trigger("willclose"),this.opened=!1,a.transition?(h.removeClass(a.openClass).addClass(a.closedClass),setTimeout(i,n)):h.stop().fadeOut(n,o,i),a.disableMask||this.$mask.stop().fadeOut(n,o)}},toggle:function(t){"none"===this.$target.css("display")?this.open(t):this.close(t)},bind:function(){var e=this.elem,i=this.$elem,s=this.$close,a=this.options,n=a.namespace,o={},h=this;t.each(["Open","Close"],function(){var e=a["on"+this];t.isFunction(e)&&(o["minlight"+this.toLowerCase()+n]=e),e=a["will"+this],t.isFunction(e)&&(o["minlightwill"+this.toLowerCase()+n]=e)}),t.nodeName(e,"a")||t.nodeName(e,"button")?o["click"+n]=function(t){t.preventDefault(),h.toggle()}:void 0!==i.prop("tabIndex")&&(o["focus"+n]=function(){h.open(function(){i.blur()})}),t.isEmptyObject(o)||i.on(o),a.closeOnMaskClick&&(s=s.add(this.$mask)),s.on("click"+n,function(t){t.preventDefault(),h.close()})},unbind:function(){this.$elem.add(this.$mask).add(this.$close).off(this.options.namespace)},destroy:function(){this.unbind(),this._removeTarget(),t.removeData(this.elem,e)},option:function(e,i){var s;if(!e)return t.extend({},this.options);if("string"==typeof e){if(void 0===i)return this.options[e];s={},s[e]=i}else s=e;this._setOptions(s)},_setOptions:function(e){var i=this;t.each(e,function(e,s){switch(e){case"container":if(s=t(s),!s.length)return;s.append(i.$mask,i.$target);break;case"imgWidth":case"imgHeight":i.$img&&void 0===i.$elem.attr("data-"+e)&&i.$img[e.replace("img","").toLowerCase()](s);break;case"target":case"disableMask":i._removeTarget();case"closeOnMaskClick":case"namespace":i.unbind()}switch(i.options[e]=s,e){case"fadeTime":case"easing":i.unbind(),i.bind();break;case"target":case"disableMask":i._setTarget();case"closeOnMaskClick":case"namespace":i.bind()}})},_trigger:function(t){var e=s.call(arguments,1);this.$elem.triggerHandler("minlight"+t,e.length?[this].concat(e):[this])},_setTarget:function(){var e=this.elem,i=this.$elem,s=this.options,a=s.target,n=t(a);n.length||(t.nodeName(e,"a")||void 0!==i.prop("tabIndex")?(this.content||(this.content=this.$img=t("<img>").attr({alt:i.attr("title"),src:s.href||e.href,width:s.imgWidth,height:s.imgHeight})),n=t(s.skeleton).data("_minGenerated",!0).prepend(this.content),n.attr("id",a.replace("#","").replace(/\\/g,""))):n=i),n.length||t.error("minLight - target not found: "+a),t.contains(document,n[0])||n.appendTo(s.container),n.addClass(s.lightboxClass).data("_minNumAttached",(n.data("_minNumAttached")||0)+1),s.transition&&n.addClass(s.closedClass),s.disableMask?this.$mask=t():(this.$mask=n.prev("."+s.maskClass.split(" ")[0]),this.$mask.length||(this.$mask=t("<div>").addClass(s.maskClass).insertBefore(n))),this.$target=n,this.$close=n.find(".lightbox-close")},_removeTarget:function(){var t=this.$target,e=t.data("_minNumAttached"),i=t.data("_minGenerated");(!e||1>=e)&&(i&&t.remove(),this.$mask.remove()),t.data("_minNumAttached",e&&e-1)},_expandMask:function(){var e=t(document).height(),i=t(window).height();this.$mask.height(e>i?e:i)}},t.fn.minLight=function(i){var n,o,h,r;return"string"==typeof i?(r=[],o=s.call(arguments,1),this.each(function(){n=t.data(this,e),n&&"_"!==i.charAt(0)&&"function"==typeof(h=n[i])&&void 0!==(h=h.apply(n,o))&&r.push(h)}),r.length?1===r.length?r[0]:r:this):this.each(function(){new a(this,i)})},a});